DELETE FROM compra WHERE codigo_compra IN (SELECT produto.codigo FROM venda INNER JOIN compra ON venda.codigo_venda = compra.codigo_compra INNER JOIN produto ON compra.codigo_compra = produto.codigo GROUP BY produto.codigo HAVING sum(compra.quantidade_compra - venda.quantidade_venda) = 0); DELETE FROM venda WHERE codigo_venda IN (SELECT produto.codigo FROM venda INNER JOIN compra ON venda.codigo_venda = compra.codigo_compra INNER JOIN produto ON compra.codigo_compra = produto.codigo GROUP BY produto.codigo HAVING sum(compra.quantidade_compra - venda.quantidade_venda) = 0); DELETE FROM produto WHERE codigo IN (SELECT produto.codigo FROM venda INNER JOIN compra ON venda.codigo_venda = compra.codigo_compra INNER JOIN produto ON compra.codigo_compra = produto.codigo GROUP BY produto.codigo HAVING sum(compra.quantidade_compra - venda.quantidade_venda) = 0);